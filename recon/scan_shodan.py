import shodan
import time
import sys

SHODAN_API_KEY = "REPLACEME"

api = shodan.Shodan(SHODAN_API_KEY)

# Wrap the request in a try/ except block to catch errors
try:
# Search Shodan
    results = api.search('net:'+sys.argv[1])
    for service in results['matches']:
        hostinfo = api.host(service['ip_str'])

        
        #Not sure if it's correct, but you should do something,
        #like this:
        portlist = ""
        try:
            for port in hostinfo['ports']:
                portlist = portlist + " " + str(port)
        except:
            print "no port"
        print service['ip_str'] + portlist
        time.sleep(1.1)

except shodan.APIError, e:
    print 'Error: %s' % e
